<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html lang="zh-CN"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>心灵树洞 - 匿名倾诉与倾听</title>
    <script src="./心灵树洞 - 匿名倾诉与倾听_files/saved_resource"></script>
    <link rel="stylesheet" href="./心灵树洞 - 匿名倾诉与倾听_files/all.min.css">
    <link rel="stylesheet" href="./心灵树洞 - 匿名倾诉与倾听_files/v4-shims.min.css">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#8B7355',
                        secondary: '#D4B896',
                        accent: '#F5E6D3',
                        warm: '#FFF8DC',
                        earth: '#A0522D'
                    },
                    fontFamily: {
                        'handwriting': ['Georgia', 'serif'],
                    }
                }
            }
        }
    </script>
    
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .text-shadow {
                text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            }
            .letter-fall {
                animation: letterFall 8s infinite linear;
            }
            .treehole-enter {
                animation: treeholeEnter 2s ease-in-out forwards;
            }
            .float-animation {
                animation: float 3s ease-in-out infinite;
            }
            .pulse-glow {
                animation: pulseGlow 2s ease-in-out infinite alternate;
            }
            .fade-in {
                animation: fadeIn 0.5s ease-in-out forwards;
            }
            .slide-up {
                animation: slideUp 0.6s ease-out forwards;
            }
        }
        
        @keyframes letterFall {
            0% {
                transform: translateY(-100px) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
        
        @keyframes treeholeEnter {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(0.8);
                opacity: 0.7;
            }
            100% {
                transform: scale(10);
                opacity: 0;
            }
        }
        
        @keyframes float {
            0%, 100% {
                transform: translateY(0px);
            }
            50% {
                transform: translateY(-10px);
            }
        }
        
        @keyframes pulseGlow {
            0% {
                box-shadow: 0 0 20px rgba(245, 230, 211, 0.5);
            }
            100% {
                box-shadow: 0 0 40px rgba(245, 230, 211, 0.8);
            }
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
        
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .treehole-bg {
            background-image: url('https://aka.doubaocdn.com/s/7s861w0Z9s');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }
        
        .letter-card {
            transition: all 0.3s ease;
        }
        
        .letter-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        
        .modal-backdrop {
            backdrop-filter: blur(5px);
        }
        
        .user-info {
            background: rgba(139, 115, 85, 0.9);
            backdrop-filter: blur(10px);
        }
    </style>
<style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.container{width:100%}@media (min-width: 640px){.container{max-width:640px}}@media (min-width: 768px){.container{max-width:768px}}@media (min-width: 1024px){.container{max-width:1024px}}@media (min-width: 1280px){.container{max-width:1280px}}@media (min-width: 1536px){.container{max-width:1536px}}.pointer-events-none{pointer-events:none}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.inset-0{inset:0px}.inset-4{inset:1rem}.bottom-1\/4{bottom:25%}.left-1\/2{left:50%}.right-4{right:1rem}.top-1\/2{top:50%}.top-4{top:1rem}.z-10{z-index:10}.z-50{z-index:50}.mx-4{margin-left:1rem;margin-right:1rem}.mx-auto{margin-left:auto;margin-right:auto}.mb-12{margin-bottom:3rem}.mb-16{margin-bottom:4rem}.mb-2{margin-bottom:0.5rem}.mb-20{margin-bottom:5rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.mb-8{margin-bottom:2rem}.mr-2{margin-right:0.5rem}.mt-12{margin-top:3rem}.mt-4{margin-top:1rem}.block{display:block}.flex{display:flex}.grid{display:grid}.hidden{display:none}.h-16{height:4rem}.h-24{height:6rem}.h-32{height:8rem}.min-h-screen{min-height:100vh}.w-16{width:4rem}.w-24{width:6rem}.w-32{width:8rem}.w-full{width:100%}.max-w-2xl{max-width:42rem}.max-w-3xl{max-width:48rem}.max-w-4xl{max-width:56rem}.max-w-6xl{max-width:72rem}.max-w-md{max-width:28rem}.-translate-x-1\/2{--tw-translate-x:-50%;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-y-1\/2{--tw-translate-y:-50%;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.transform{transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.cursor-pointer{cursor:pointer}.resize-none{resize:none}.grid-cols-1{grid-template-columns:repeat(1, minmax(0, 1fr))}.flex-col{flex-direction:column}.items-center{align-items:center}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-12{gap:3rem}.gap-3{gap:0.75rem}.gap-4{gap:1rem}.gap-6{gap:1.5rem}.gap-8{gap:2rem}.space-y-4 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(1rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem * var(--tw-space-y-reverse))}.space-y-6 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(1.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1.5rem * var(--tw-space-y-reverse))}.overflow-hidden{overflow:hidden}.overflow-x-hidden{overflow-x:hidden}.rounded-2xl{border-radius:1rem}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:0.5rem}.border{border-width:1px}.border-secondary{--tw-border-opacity:1;border-color:rgb(212 184 150 / var(--tw-border-opacity, 1))}.bg-accent{--tw-bg-opacity:1;background-color:rgb(245 230 211 / var(--tw-bg-opacity, 1))}.bg-black{--tw-bg-opacity:1;background-color:rgb(0 0 0 / var(--tw-bg-opacity, 1))}.bg-earth{--tw-bg-opacity:1;background-color:rgb(160 82 45 / var(--tw-bg-opacity, 1))}.bg-primary{--tw-bg-opacity:1;background-color:rgb(139 115 85 / var(--tw-bg-opacity, 1))}.bg-secondary{--tw-bg-opacity:1;background-color:rgb(212 184 150 / var(--tw-bg-opacity, 1))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-opacity-20{--tw-bg-opacity:0.2}.bg-opacity-50{--tw-bg-opacity:0.5}.bg-opacity-70{--tw-bg-opacity:0.7}.bg-gradient-to-b{background-image:linear-gradient(to bottom, var(--tw-gradient-stops))}.from-accent{--tw-gradient-from:#F5E6D3 var(--tw-gradient-from-position);--tw-gradient-to:rgb(245 230 211 / 0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from), var(--tw-gradient-to)}.from-earth{--tw-gradient-from:#A0522D var(--tw-gradient-from-position);--tw-gradient-to:rgb(160 82 45 / 0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from), var(--tw-gradient-to)}.to-primary{--tw-gradient-to:#8B7355 var(--tw-gradient-to-position)}.to-warm{--tw-gradient-to:#FFF8DC var(--tw-gradient-to-position)}.p-6{padding:1.5rem}.p-8{padding:2rem}.px-4{padding-left:1rem;padding-right:1rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.px-8{padding-left:2rem;padding-right:2rem}.py-16{padding-top:4rem;padding-bottom:4rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.py-3{padding-top:0.75rem;padding-bottom:0.75rem}.text-center{text-align:center}.font-handwriting{font-family:Georgia, serif}.text-2xl{font-size:1.5rem;line-height:2rem}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-5xl{font-size:3rem;line-height:1}.text-6xl{font-size:3.75rem;line-height:1}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:0.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.font-medium{font-weight:500}.leading-relaxed{line-height:1.625}.text-accent{--tw-text-opacity:1;color:rgb(245 230 211 / var(--tw-text-opacity, 1))}.text-earth{--tw-text-opacity:1;color:rgb(160 82 45 / var(--tw-text-opacity, 1))}.text-primary{--tw-text-opacity:1;color:rgb(139 115 85 / var(--tw-text-opacity, 1))}.text-warm{--tw-text-opacity:1;color:rgb(255 248 220 / var(--tw-text-opacity, 1))}.shadow-2xl{--tw-shadow:0 25px 50px -12px rgb(0 0 0 / 0.25);--tw-shadow-colored:0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-lg{--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-xl{--tw-shadow:0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.transition-all{transition-property:all;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.duration-300{transition-duration:300ms}.text-shadow {
                text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            }.float-animation {
                animation: float 3s ease-in-out infinite;
            }.pulse-glow {
                animation: pulseGlow 2s ease-in-out infinite alternate;
            }.fade-in {
                animation: fadeIn 0.5s ease-in-out forwards;
            }.slide-up {
                animation: slideUp 0.6s ease-out forwards;
            }
        
        @keyframes letterFall {
            0% {
                transform: translateY(-100px) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
        
        @keyframes treeholeEnter {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(0.8);
                opacity: 0.7;
            }
            100% {
                transform: scale(10);
                opacity: 0;
            }
        }
        
        @keyframes float {
            0%, 100% {
                transform: translateY(0px);
            }
            50% {
                transform: translateY(-10px);
            }
        }
        
        @keyframes pulseGlow {
            0% {
                box-shadow: 0 0 20px rgba(245, 230, 211, 0.5);
            }
            100% {
                box-shadow: 0 0 40px rgba(245, 230, 211, 0.8);
            }
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
        
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .treehole-bg {
            background-image: url('https://aka.doubaocdn.com/s/7s861w0Z9s');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }
        
        .letter-card {
            transition: all 0.3s ease;
        }
        
        .letter-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        
        .modal-backdrop {
            -webkit-backdrop-filter: blur(5px);
                    backdrop-filter: blur(5px);
        }
        
        .user-info {
            background: rgba(139, 115, 85, 0.9);
            -webkit-backdrop-filter: blur(10px);
                    backdrop-filter: blur(10px);
        }
        
        .hover\:bg-accent:hover{--tw-bg-opacity:1;background-color:rgb(245 230 211 / var(--tw-bg-opacity, 1))}
        
        .hover\:bg-earth:hover{--tw-bg-opacity:1;background-color:rgb(160 82 45 / var(--tw-bg-opacity, 1))}
        
        .hover\:bg-primary:hover{--tw-bg-opacity:1;background-color:rgb(139 115 85 / var(--tw-bg-opacity, 1))}
        
        .hover\:bg-secondary:hover{--tw-bg-opacity:1;background-color:rgb(212 184 150 / var(--tw-bg-opacity, 1))}
        
        .hover\:underline:hover{-webkit-text-decoration-line:underline;text-decoration-line:underline}
        
        .hover\:shadow-2xl:hover{--tw-shadow:0 25px 50px -12px rgb(0 0 0 / 0.25);--tw-shadow-colored:0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}
        
        .focus\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}
        
        .focus\:ring-2:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000)}
        
        .focus\:ring-primary:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(139 115 85 / var(--tw-ring-opacity, 1))}
        
        .disabled\:cursor-not-allowed:disabled{cursor:not-allowed}
        
        .disabled\:opacity-50:disabled{opacity:0.5}
        
        @media (min-width: 768px){.md\:h-48{height:12rem}.md\:w-48{width:12rem}.md\:grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}.md\:flex-row{flex-direction:row}.md\:text-2xl{font-size:1.5rem;line-height:2rem}.md\:text-8xl{font-size:6rem;line-height:1}}
        
        @media (min-width: 1024px){.lg\:grid-cols-3{grid-template-columns:repeat(3, minmax(0, 1fr))}}
    </style></head>
<body class="min-h-screen overflow-x-hidden">
    <!-- 首页 - 树洞场景 -->
    <div id="homePage" class="treehole-bg min-h-screen flex items-center justify-center relative">
        <div class="absolute inset-0 bg-black bg-opacity-20"></div>
        
        <!-- 标题 -->
        <div class="text-center z-10 mb-20">
            <h1 class="text-6xl md:text-8xl font-handwriting text-warm text-shadow mb-4 float-animation">
                心灵树洞
            </h1>
            <p class="text-xl md:text-2xl text-accent text-shadow">
                在这里，你的心声会被温柔聆听
            </p>
        </div>
        
        <!-- 可点击的树洞 -->
        <div id="treehole" class="absolute bottom-1/4 left-1/2 transform -translate-x-1/2 cursor-pointer pulse-glow">
            <div class="w-32 h-32 md:w-48 md:h-48 bg-earth rounded-full relative overflow-hidden">
                <div class="absolute inset-4 bg-black bg-opacity-70 rounded-full"></div>
                <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-accent text-2xl">
                    <i class="fa fa-heart"></i>
                </div>
            </div>
            <p class="text-center text-warm mt-4 text-lg font-handwriting">
                点击树洞，开始倾诉
            </p>
        </div>
        
        <!-- 登录注册按钮 / 用户信息 -->
        <div id="userArea" class="absolute top-4 right-4 flex flex-col md:flex-row gap-3">
            <button id="loginBtn" class="bg-primary hover:bg-earth text-warm px-4 py-2 rounded-lg transition-all duration-300">
                <i class="fa fa-sign-in mr-2"></i>登录
            </button>
            <button id="registerBtn" class="bg-secondary hover:bg-primary text-earth px-4 py-2 rounded-lg transition-all duration-300">
                <i class="fa fa-user-plus mr-2"></i>注册
            </button>
        </div>
    </div>
    
    <!-- 登录提示模态框 -->
    <div id="loginRequiredModal" class="hidden fixed inset-0 z-50 flex items-center justify-center">
        <div class="modal-backdrop absolute inset-0 bg-black bg-opacity-50"></div>
        <div class="bg-white rounded-2xl p-8 max-w-md w-full mx-4 relative z-10 shadow-2xl slide-up">
            <div class="text-center mb-6">
                <div class="w-16 h-16 mx-auto mb-4 bg-primary rounded-full flex items-center justify-center">
                    <i class="fa fa-lock text-2xl text-warm"></i>
                </div>
                <h3 class="text-2xl font-handwriting text-primary mb-2">
                    需要登录
                </h3>
                <p class="text-earth">
                    请先登录或注册账号，才能使用树洞功能
                </p>
            </div>
            
            <div class="flex justify-center gap-4">
                <button id="closeLoginRequiredModal" class="bg-earth hover:bg-primary text-warm px-6 py-2 rounded-lg transition-all duration-300">
                    取消
                </button>
                <button id="goToLoginBtn" class="bg-primary hover:bg-earth text-warm px-6 py-2 rounded-lg transition-all duration-300">
                    去登录
                </button>
            </div>
        </div>
    </div>
    
    <!-- 倾诉功能页面 -->
    <div id="倾诉Page" class="hidden min-h-screen bg-gradient-to-b from-accent to-warm py-16">
        <div class="container mx-auto px-4">
            <div class="text-center mb-16 fade-in">
                <h2 class="text-5xl font-handwriting text-primary mb-4">
                    选择你的方式
                </h2>
                <p class="text-lg text-earth">
                    在这里，你可以倾诉心声，也可以倾听他人的故事
                </p>
            </div>
            
            <div class="grid md:grid-cols-2 gap-12 max-w-4xl mx-auto">
                <!-- 写信选项 -->
                <div class="bg-white rounded-2xl p-8 shadow-xl hover:shadow-2xl transition-all duration-300 cursor-pointer letter-card slide-up" id="writeLetterBtn">
                    <div class="text-center">
                        <div class="w-24 h-24 mx-auto mb-6 bg-secondary rounded-full flex items-center justify-center">
                            <i class="fa fa-pencil text-3xl text-earth"></i>
                        </div>
                        <h3 class="text-2xl font-handwriting text-primary mb-4">
                            写下心声
                        </h3>
                        <p class="text-earth">
                            把你的烦恼、快乐或秘密写下来，匿名投入树洞中
                        </p>
                    </div>
                </div>
                
                <!-- 窥探树洞选项 -->
                <div class="bg-white rounded-2xl p-8 shadow-xl hover:shadow-2xl transition-all duration-300 cursor-pointer letter-card slide-up" id="exploreHoleBtn">
                    <div class="text-center">
                        <div class="w-24 h-24 mx-auto mb-6 bg-primary rounded-full flex items-center justify-center">
                            <i class="fa fa-eye text-3xl text-warm"></i>
                        </div>
                        <h3 class="text-2xl font-handwriting text-primary mb-4">
                            窥探树洞
                        </h3>
                        <p class="text-earth">
                            进入树洞，看看其他人分享的故事和心声
                        </p>
                    </div>
                </div>
            </div>
            
            <!-- 返回首页按钮 -->
            <div class="text-center mt-12 fade-in">
                <button id="backToHomeBtn" class="bg-earth hover:bg-primary text-warm px-6 py-3 rounded-lg transition-all duration-300">
                    <i class="fa fa-arrow-left mr-2"></i>返回树洞
                </button>
            </div>
        </div>
    </div>
    
    <!-- 写信页面 -->
    <div id="writeLetterPage" class="hidden min-h-screen bg-gradient-to-b from-accent to-warm py-16">
        <div class="container mx-auto px-4 max-w-3xl">
            <div class="bg-white rounded-2xl p-8 shadow-xl slide-up">
                <div class="text-center mb-8">
                    <h2 class="text-4xl font-handwriting text-primary mb-4">
                        写下你的心声
                    </h2>
                    <p class="text-earth">
                        你的信件将以匿名形式保存在树洞中，只有你能收到他人的拥抱
                    </p>
                </div>
                
                <form id="letterForm" class="space-y-6">
                    <div>
                        <label for="letterTitle" class="block text-earth text-sm font-medium mb-2">
                            信件标题（可选）
                        </label>
                        <input type="text" id="letterTitle" placeholder="给你的信件起个标题..." class="w-full px-4 py-3 border border-secondary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary">
                    </div>
                    
                    <div>
                        <label for="letterContent" class="block text-earth text-sm font-medium mb-2">
                            信件内容
                        </label>
                        <textarea id="letterContent" rows="10" placeholder="在这里写下你的心声..." class="w-full px-4 py-3 border border-secondary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary resize-none" required=""></textarea>
                    </div>
                    
                    <div class="flex justify-between items-center">
                        <button type="button" id="backTo倾诉Btn" class="bg-earth hover:bg-primary text-warm px-6 py-3 rounded-lg transition-all duration-300">
                            <i class="fa fa-arrow-left mr-2"></i>返回
                        </button>
                        <button type="submit" id="submitLetterBtn" class="bg-primary hover:bg-earth text-warm px-8 py-3 rounded-lg transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed">
                            <i class="fa fa-paper-plane mr-2"></i>投入树洞
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- 树洞内部页面 -->
    <div id="treeholeInsidePage" class="hidden min-h-screen bg-gradient-to-b from-earth to-primary py-16 relative overflow-hidden">
        <!-- 背景信件飘落效果 -->
        <div id="floatingLetters" class="absolute inset-0 pointer-events-none"></div>
        
        <div class="container mx-auto px-4 relative z-10">
            <div class="text-center mb-12 fade-in">
                <h2 class="text-5xl font-handwriting text-warm text-shadow mb-4">
                    树洞深处
                </h2>
                <p class="text-xl text-accent text-shadow">
                    在这里，每一封信都承载着一个故事
                </p>
            </div>
            
            <!-- 信件网格 -->
            <div id="lettersGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 max-w-6xl mx-auto">
                <!-- 信件卡片将通过JavaScript动态生成 -->
            </div>
            
            <!-- 控制按钮 -->
            <div class="text-center mt-12 flex justify-center gap-6 fade-in">
                <button id="refreshLettersBtn" class="bg-secondary hover:bg-accent text-earth px-6 py-3 rounded-lg transition-all duration-300">
                    <i class="fa fa-bullseye mr-2"></i>刷新信件
                </button>
                <button id="leaveTreeholeBtn" class="bg-accent hover:bg-secondary text-earth px-6 py-3 rounded-lg transition-all duration-300">
                    <i class="fa fa-arrow-left mr-2"></i>离开树洞
                </button>
            </div>
        </div>
    </div>
    
    <!-- 信件详情模态框 -->
    <div id="letterModal" class="hidden fixed inset-0 z-50 flex items-center justify-center">
        <div class="modal-backdrop absolute inset-0 bg-black bg-opacity-50"></div>
        <div class="bg-white rounded-2xl p-8 max-w-2xl w-full mx-4 relative z-10 shadow-2xl slide-up">
            <div class="text-center mb-6">
                <h3 id="modalLetterTitle" class="text-3xl font-handwriting text-primary mb-2"></h3>
                <p id="modalLetterDate" class="text-earth text-sm"></p>
            </div>
            
            <div id="modalLetterContent" class="text-earth text-lg leading-relaxed mb-8 p-6 bg-accent rounded-lg">
                <!-- 信件内容将通过JavaScript动态生成 -->
            </div>
            
            <div class="flex justify-between items-center">
                <button id="sendHugBtn" class="bg-primary hover:bg-earth text-warm px-6 py-3 rounded-lg transition-all duration-300">
                    <i class="fa fa-heart mr-2"></i>发送拥抱
                </button>
                <button id="closeModalBtn" class="bg-earth hover:bg-primary text-warm px-6 py-3 rounded-lg transition-all duration-300">
                    <i class="fa fa-times mr-2"></i>关闭
                </button>
            </div>
        </div>
    </div>
    
    <!-- 登录模态框 -->
    <div id="loginModal" class="hidden fixed inset-0 z-50 flex items-center justify-center">
        <div class="modal-backdrop absolute inset-0 bg-black bg-opacity-50"></div>
        <div class="bg-white rounded-2xl p-8 max-w-md w-full mx-4 relative z-10 shadow-2xl slide-up">
            <div class="text-center mb-6">
                <h3 class="text-3xl font-handwriting text-primary mb-2">
                    登录
                </h3>
                <p class="text-earth">
                    登录你的账号，管理你的信件和拥抱
                </p>
            </div>
            
            <form id="loginForm" class="space-y-4">
                <div>
                    <label for="loginUsername" class="block text-earth text-sm font-medium mb-2">
                        用户名
                    </label>
                    <input type="text" id="loginUsername" placeholder="请输入用户名" class="w-full px-4 py-3 border border-secondary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required="">
                </div>
                
                <div>
                    <label for="loginPassword" class="block text-earth text-sm font-medium mb-2">
                        密码
                    </label>
                    <input type="password" id="loginPassword" placeholder="请输入密码" class="w-full px-4 py-3 border border-secondary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required="">
                </div>
                
                <div class="flex justify-between items-center">
                    <button type="button" id="closeLoginModal" class="bg-earth hover:bg-primary text-warm px-4 py-2 rounded-lg transition-all duration-300">
                        关闭
                    </button>
                    <button type="submit" class="bg-primary hover:bg-earth text-warm px-6 py-2 rounded-lg transition-all duration-300">
                        登录
                    </button>
                </div>
            </form>
            
            <div class="text-center mt-4">
                <p class="text-earth text-sm">
                    还没有账号？<button id="switchToRegister" class="text-primary hover:underline">立即注册</button>
                </p>
            </div>
        </div>
    </div>
    
    <!-- 注册模态框 -->
    <div id="registerModal" class="hidden fixed inset-0 z-50 flex items-center justify-center">
        <div class="modal-backdrop absolute inset-0 bg-black bg-opacity-50"></div>
        <div class="bg-white rounded-2xl p-8 max-w-md w-full mx-4 relative z-10 shadow-2xl slide-up">
            <div class="text-center mb-6">
                <h3 class="text-3xl font-handwriting text-primary mb-2">
                    注册
                </h3>
                <p class="text-earth">
                    创建你的账号，开始使用树洞服务
                </p>
            </div>
            
            <form id="registerForm" class="space-y-4">
                <div>
                    <label for="registerUsername" class="block text-earth text-sm font-medium mb-2">
                        用户名
                    </label>
                    <input type="text" id="registerUsername" placeholder="请输入用户名" class="w-full px-4 py-3 border border-secondary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required="">
                </div>
                
                <div>
                    <label for="registerEmail" class="block text-earth text-sm font-medium mb-2">
                        邮箱
                    </label>
                    <input type="email" id="registerEmail" placeholder="请输入邮箱" class="w-full px-4 py-3 border border-secondary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required="">
                </div>
                
                <div>
                    <label for="registerPassword" class="block text-earth text-sm font-medium mb-2">
                        密码
                    </label>
                    <input type="password" id="registerPassword" placeholder="请输入密码" class="w-full px-4 py-3 border border-secondary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required="">
                </div>
                
                <div>
                    <label for="confirmPassword" class="block text-earth text-sm font-medium mb-2">
                        确认密码
                    </label>
                    <input type="password" id="confirmPassword" placeholder="请再次输入密码" class="w-full px-4 py-3 border border-secondary rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required="">
                </div>
                
                <div class="flex justify-between items-center">
                    <button type="button" id="closeRegisterModal" class="bg-earth hover:bg-primary text-warm px-4 py-2 rounded-lg transition-all duration-300">
                        关闭
                    </button>
                    <button type="submit" class="bg-primary hover:bg-earth text-warm px-6 py-2 rounded-lg transition-all duration-300">
                        注册
                    </button>
                </div>
            </form>
            
            <div class="text-center mt-4">
                <p class="text-earth text-sm">
                    已有账号？<button id="switchToLogin" class="text-primary hover:underline">立即登录</button>
                </p>
            </div>
        </div>
    </div>
    
    <!-- 拥抱通知 -->
    <div id="hugNotification" class="hidden fixed top-4 right-4 bg-primary text-warm px-6 py-3 rounded-lg shadow-lg z-50 slide-up">
        <div class="flex items-center">
            <i class="fa fa-heart mr-2"></i>
            <span>有人给你的信件发送了一个拥抱！</span>
        </div>
    </div>

    <script>
        // 全局变量
        let currentUser = null;
        let letters = [];
        let users = [];
        
        // 页面元素
        const homePage = document.getElementById('homePage');
        const 倾诉Page = document.getElementById('倾诉Page');
        const writeLetterPage = document.getElementById('writeLetterPage');
        const treeholeInsidePage = document.getElementById('treeholeInsidePage');
        const letterModal = document.getElementById('letterModal');
        const loginModal = document.getElementById('loginModal');
        const registerModal = document.getElementById('registerModal');
        const loginRequiredModal = document.getElementById('loginRequiredModal');
        
        // 初始化数据
        function initData() {
            // 从localStorage加载数据
            if (localStorage.getItem('users')) {
                users = JSON.parse(localStorage.getItem('users'));
            } else {
                // 创建默认测试用户
                users = [
                    {
                        id: 1,
                        username: 'testuser1',
                        password: '123456',
                        email: 'test1@example.com',
                        letters: [],
                        hugsReceived: []
                    },
                    {
                        id: 2,
                        username: 'testuser2',
                        password: '123456',
                        email: 'test2@example.com',
                        letters: [],
                        hugsReceived: []
                    }
                ];
                localStorage.setItem('users', JSON.stringify(users));
            }
            
            if (localStorage.getItem('letters')) {
                letters = JSON.parse(localStorage.getItem('letters'));
            } else {
                // 创建默认测试信件
                letters = [
                    {
                        id: 1,
                        title: '我的小秘密',
                        content: '今天我偷偷买了一块蛋糕，没有和家人分享，感觉有点内疚，但真的很好吃。',
                        authorId: 1,
                        date: '2026-02-01',
                        hugs: 5
                    },
                    {
                        id: 2,
                        title: '工作的烦恼',
                        content: '最近工作压力好大，感觉自己快要撑不下去了，不知道该怎么办。',
                        authorId: 2,
                        date: '2026-02-02',
                        hugs: 12
                    },
                    {
                        id: 3,
                        title: '暗恋的心情',
                        content: '我喜欢上了公司的同事，但不敢告诉他，每天能看到他就很开心了。',
                        authorId: 1,
                        date: '2026-02-03',
                        hugs: 8
                    }
                ];
                localStorage.setItem('letters', JSON.stringify(letters));
            }
            
            // 检查当前登录状态
            if (localStorage.getItem('currentUser')) {
                currentUser = JSON.parse(localStorage.getItem('currentUser'));
                updateUserArea();
            }
        }
        
        // 更新用户区域显示
        function updateUserArea() {
            const userArea = document.getElementById('userArea');
            
            if (currentUser) {
                // 显示用户信息和退出按钮
                userArea.innerHTML = `
                    <div class="user-info text-warm px-4 py-2 rounded-lg flex items-center gap-3">
                        <i class="fa fa-user"></i>
                        <span>${currentUser.username}</span>
                    </div>
                    <button id="logoutBtn" class="bg-earth hover:bg-primary text-warm px-4 py-2 rounded-lg transition-all duration-300">
                        <i class="fa fa-sign-out mr-2"></i>退出
                    </button>
                `;
                
                // 绑定退出登录事件
                document.getElementById('logoutBtn').addEventListener('click', logout);
            } else {
                // 显示登录注册按钮
                userArea.innerHTML = `
                    <button id="loginBtn" class="bg-primary hover:bg-earth text-warm px-4 py-2 rounded-lg transition-all duration-300">
                        <i class="fa fa-sign-in mr-2"></i>登录
                    </button>
                    <button id="registerBtn" class="bg-secondary hover:bg-primary text-earth px-4 py-2 rounded-lg transition-all duration-300">
                        <i class="fa fa-user-plus mr-2"></i>注册
                    </button>
                `;
                
                // 绑定登录注册事件
                document.getElementById('loginBtn').addEventListener('click', () => showModal('loginModal'));
                document.getElementById('registerBtn').addEventListener('click', () => showModal('registerModal'));
            }
        }
        
        // 检查登录状态
        function checkLoginStatus() {
            if (!currentUser) {
                showModal('loginRequiredModal');
                return false;
            }
            return true;
        }
        
        // 页面切换函数
        function showPage(pageId) {
            // 隐藏所有页面
            const pages = [homePage, 倾诉Page, writeLetterPage, treeholeInsidePage];
            pages.forEach(page => page.classList.add('hidden'));
            
            // 显示指定页面
            document.getElementById(pageId).classList.remove('hidden');
        }
        
        // 显示模态框
        function showModal(modalId) {
            document.getElementById(modalId).classList.remove('hidden');
        }
        
        // 隐藏模态框
        function hideModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
        }
        
        // 生成随机信件（排除当前用户的信件）
        function generateRandomLetters(count) {
            // 过滤掉当前用户的信件
            const otherLetters = letters.filter(letter => letter.authorId !== currentUser.id);
            
            // 如果没有其他用户的信件，创建一些示例信件
            if (otherLetters.length === 0) {
                const sampleLetters = [
                    {
                        title: '我的梦想',
                        content: '我一直想成为一名画家，但家人希望我找一份稳定的工作。我不知道该如何选择。',
                        authorId: 999, // 使用不存在的用户ID
                        date: new Date(Date.now() - Math.random() * 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                        hugs: Math.floor(Math.random() * 20)
                    },
                    {
                        title: '友谊的困惑',
                        content: '最近和最好的朋友吵架了，我们已经一个星期没有说话了，我很想念她。',
                        authorId: 998, // 使用不存在的用户ID
                        date: new Date(Date.now() - Math.random() * 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                        hugs: Math.floor(Math.random() * 15)
                    }
                ];
                
                // 随机选择信件
                const randomLetters = [];
                for (let i = 0; i < count; i++) {
                    const randomLetter = sampleLetters[Math.floor(Math.random() * sampleLetters.length)];
                    randomLetters.push({
                        ...randomLetter,
                        id: Date.now() + i
                    });
                }
                
                return randomLetters;
            }
            
            // 随机选择信件
            const randomLetters = [];
            for (let i = 0; i < count; i++) {
                const randomIndex = Math.floor(Math.random() * otherLetters.length);
                randomLetters.push(otherLetters[randomIndex]);
            }
            
            return randomLetters;
        }
        
        // 渲染信件网格
        function renderLettersGrid() {
            const lettersGrid = document.getElementById('lettersGrid');
            lettersGrid.innerHTML = '';
            
            // 随机选择6-9封信
            const randomLetters = generateRandomLetters(Math.floor(Math.random() * 4) + 6);
            
            randomLetters.forEach(letter => {
                const letterCard = document.createElement('div');
                letterCard.className = 'bg-white rounded-xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 cursor-pointer letter-card';
                letterCard.innerHTML = `
                    <div class="text-center">
                        <div class="w-16 h-16 mx-auto mb-4 bg-secondary rounded-full flex items-center justify-center">
                            <img src="https://aka.doubaocdn.com/s/y4NV1w0ZA3" alt="信件" class="w-8 h-8">
                        </div>
                        <h4 class="text-lg font-handwriting text-primary mb-2">${letter.title}</h4>
                        <p class="text-earth text-sm mb-3">${letter.content.substring(0, 50)}...</p>
                        <div class="flex items-center justify-center text-primary">
                            <i class="fa fa-heart mr-1"></i>
                            <span>${letter.hugs}</span>
                        </div>
                    </div>
                `;
                
                letterCard.addEventListener('click', () => {
                    showLetterModal(letter);
                });
                
                lettersGrid.appendChild(letterCard);
            });
        }
        
        // 显示信件详情模态框
        function showLetterModal(letter) {
            document.getElementById('modalLetterTitle').textContent = letter.title;
            document.getElementById('modalLetterDate').textContent = `写于 ${letter.date}`;
            document.getElementById('modalLetterContent').textContent = letter.content;
            
            // 保存当前信件ID，用于发送拥抱
            document.getElementById('sendHugBtn').dataset.letterId = letter.id;
            document.getElementById('sendHugBtn').dataset.authorId = letter.authorId;
            
            showModal('letterModal');
        }
        
        // 发送拥抱
        function sendHug(letterId, authorId) {
            if (!currentUser) {
                alert('请先登录才能发送拥抱');
                showModal('loginModal');
                return;
            }
            
            // 找到对应的信件并增加拥抱数
            const letterIndex = letters.findIndex(letter => letter.id == letterId);
            if (letterIndex !== -1) {
                letters[letterIndex].hugs++;
                localStorage.setItem('letters', JSON.stringify(letters));
            }
            
            // 通知信件作者
            const authorIndex = users.findIndex(user => user.id == authorId);
            if (authorIndex !== -1) {
                users[authorIndex].hugsReceived.push({
                    letterId: letterId,
                    fromUser: currentUser.username,
                    date: new Date().toISOString().split('T')[0]
                });
                localStorage.setItem('users', JSON.stringify(users));
                
                // 如果作者当前在线，显示拥抱通知
                if (users[authorIndex].username === currentUser.username) {
                    const hugNotification = document.getElementById('hugNotification');
                    hugNotification.classList.remove('hidden');
                    
                    setTimeout(() => {
                        hugNotification.classList.add('hidden');
                    }, 3000);
                }
            }
            
            // 显示拥抱成功提示
            alert('拥抱已发送！');
            hideModal('letterModal');
            renderLettersGrid();
        }
        
        // 注册用户
        function registerUser(username, email, password) {
            // 检查用户名是否已存在
            if (users.find(user => user.username === username)) {
                alert('用户名已存在');
                return false;
            }
            
            // 检查邮箱是否已存在
            if (users.find(user => user.email === email)) {
                alert('邮箱已被注册');
                return false;
            }
            
            // 创建新用户
            const newUser = {
                id: Date.now(),
                username: username,
                email: email,
                password: password,
                letters: [],
                hugsReceived: []
            };
            
            users.push(newUser);
            localStorage.setItem('users', JSON.stringify(users));
            
            // 自动登录
            currentUser = newUser;
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            updateUserArea();
            
            alert('注册成功！');
            hideModal('registerModal');
            return true;
        }
        
        // 登录用户
        function loginUser(username, password) {
            const user = users.find(user => user.username === username && user.password === password);
            
            if (!user) {
                alert('用户名或密码错误');
                return false;
            }
            
            currentUser = user;
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            updateUserArea();
            
            // 检查是否有未读拥抱通知
            if (user.hugsReceived.length > 0) {
                const hugNotification = document.getElementById('hugNotification');
                hugNotification.classList.remove('hidden');
                
                setTimeout(() => {
                    hugNotification.classList.add('hidden');
                }, 5000);
            }
            
            alert('登录成功！');
            hideModal('loginModal');
            return true;
        }
        
        // 退出登录
        function logout() {
            currentUser = null;
            localStorage.removeItem('currentUser');
            updateUserArea();
            showPage('homePage');
            alert('已退出登录');
        }
        
        // 提交信件
        function submitLetter(title, content) {
            if (!currentUser) {
                alert('请先登录才能提交信件');
                showModal('loginModal');
                return false;
            }
            
            const newLetter = {
                id: Date.now(),
                title: title || '无题',
                content: content,
                authorId: currentUser.id,
                date: new Date().toISOString().split('T')[0],
                hugs: 0
            };
            
            letters.push(newLetter);
            localStorage.setItem('letters', JSON.stringify(letters));
            
            // 将信件添加到用户的信件列表
            const userIndex = users.findIndex(user => user.id === currentUser.id);
            if (userIndex !== -1) {
                users[userIndex].letters.push(newLetter.id);
                localStorage.setItem('users', JSON.stringify(users));
            }
            
            alert('信件已投入树洞！');
            showPage('倾诉Page');
            return true;
        }
        
        // 创建漂浮信件效果
        function createFloatingLetters() {
            const floatingLetters = document.getElementById('floatingLetters');
            floatingLetters.innerHTML = '';
            
            for (let i = 0; i < 10; i++) {
                const letter = document.createElement('div');
                letter.className = 'absolute letter-fall';
                letter.style.left = Math.random() * 100 + '%';
                letter.style.animationDelay = Math.random() * 5 + 's';
                letter.style.animationDuration = (Math.random() * 3 + 5) + 's';
                letter.style.opacity = Math.random() * 0.5 + 0.2;
                
                // 随机选择信件图片
                const letterImages = [
                    'https://aka.doubaocdn.com/s/hDii1w0ZA2',
                    'https://aka.doubaocdn.com/s/y4NV1w0ZA3',
                    'https://aka.doubaocdn.com/s/meUU1w0ZA3'
                ];
                
                letter.innerHTML = `
                    <img src="${letterImages[Math.floor(Math.random() * letterImages.length)]}" 
                         alt="漂浮信件" 
                         class="w-16 h-16 object-contain transform rotate-${Math.random() * 360}">
                `;
                
                floatingLetters.appendChild(letter);
            }
        }
        
        // 事件监听器
        document.addEventListener('DOMContentLoaded', function() {
            // 初始化数据
            initData();
            
            // 首页树洞点击事件
            document.getElementById('treehole').addEventListener('click', function() {
                if (!checkLoginStatus()) {
                    return;
                }
                
                // 播放树洞进入动画
                this.classList.add('treehole-enter');
                
                setTimeout(() => {
                    showPage('倾诉Page');
                    this.classList.remove('treehole-enter');
                }, 2000);
            });
            
            // 写信按钮点击事件
            document.getElementById('writeLetterBtn').addEventListener('click', function() {
                showPage('writeLetterPage');
            });
            
            // 窥探树洞按钮点击事件
            document.getElementById('exploreHoleBtn').addEventListener('click', function() {
                showPage('treeholeInsidePage');
                renderLettersGrid();
                createFloatingLetters();
            });
            
            // 返回首页按钮点击事件
            document.getElementById('backToHomeBtn').addEventListener('click', function() {
                showPage('homePage');
            });
            
            // 返回倾诉页面按钮点击事件
            document.getElementById('backTo倾诉Btn').addEventListener('click', function() {
                showPage('倾诉Page');
            });
            
            // 离开树洞按钮点击事件
            document.getElementById('leaveTreeholeBtn').addEventListener('click', function() {
                showPage('倾诉Page');
            });
            
            // 刷新信件按钮点击事件
            document.getElementById('refreshLettersBtn').addEventListener('click', function() {
                renderLettersGrid();
            });
            
            // 关闭模态框按钮点击事件
            document.getElementById('closeModalBtn').addEventListener('click', function() {
                hideModal('letterModal');
            });
            
            // 发送拥抱按钮点击事件
            document.getElementById('sendHugBtn').addEventListener('click', function() {
                const letterId = this.dataset.letterId;
                const authorId = this.dataset.authorId;
                sendHug(letterId, authorId);
            });
            
            // 登录按钮点击事件
            document.getElementById('loginBtn').addEventListener('click', function() {
                showModal('loginModal');
            });
            
            // 注册按钮点击事件
            document.getElementById('registerBtn').addEventListener('click', function() {
                showModal('registerModal');
            });
            
            // 关闭登录模态框按钮点击事件
            document.getElementById('closeLoginModal').addEventListener('click', function() {
                hideModal('loginModal');
            });
            
            // 关闭注册模态框按钮点击事件
            document.getElementById('closeRegisterModal').addEventListener('click', function() {
                hideModal('registerModal');
            });
            
            // 关闭登录提示模态框按钮点击事件
            document.getElementById('closeLoginRequiredModal').addEventListener('click', function() {
                hideModal('loginRequiredModal');
            });
            
            // 去登录按钮点击事件
            document.getElementById('goToLoginBtn').addEventListener('click', function() {
                hideModal('loginRequiredModal');
                showModal('loginModal');
            });
            
            // 切换到注册按钮点击事件
            document.getElementById('switchToRegister').addEventListener('click', function() {
                hideModal('loginModal');
                showModal('registerModal');
            });
            
            // 切换到登录按钮点击事件
            document.getElementById('switchToLogin').addEventListener('click', function() {
                hideModal('registerModal');
                showModal('loginModal');
            });
            
            // 登录表单提交事件
            document.getElementById('loginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const username = document.getElementById('loginUsername').value;
                const password = document.getElementById('loginPassword').value;
                loginUser(username, password);
            });
            
            // 注册表单提交事件
            document.getElementById('registerForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const username = document.getElementById('registerUsername').value;
                const email = document.getElementById('registerEmail').value;
                const password = document.getElementById('registerPassword').value;
                const confirmPassword = document.getElementById('confirmPassword').value;
                
                if (password !== confirmPassword) {
                    alert('两次输入的密码不一致');
                    return;
                }
                
                registerUser(username, email, password);
            });
            
            // 信件表单提交事件
            document.getElementById('letterForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const title = document.getElementById('letterTitle').value;
                const content = document.getElementById('letterContent').value;
                
                if (content.trim() === '') {
                    alert('信件内容不能为空');
                    return;
                }
                
                submitLetter(title, content);
                
                // 清空表单
                this.reset();
            });
            
            // 点击模态框背景关闭模态框
            document.querySelectorAll('.modal-backdrop').forEach(backdrop => {
                backdrop.addEventListener('click', function() {
                    const modal = this.parentElement;
                    modal.classList.add('hidden');
                });
            });
        });
    </script>


</body></html>